---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import { calculateReadingTime } from '../../utils/readingTime';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

const post = Astro.props;
const { Content } = await post.render();
const readingTime = calculateReadingTime(post.body || "");
---

<Layout title={post.data.title} description={post.data.description}>
	    <article class="max-w-4xl mx-auto">
	        <header class="mb-16 border-b-4 border-black pb-12">
	            <div class="mb-6 flex items-center gap-4">
	                <time datetime={post.data.pubDate.toISOString()} class="inline-block bg-black text-white font-bold text-lg px-4 py-2 rounded-lg">
	                    {post.data.pubDate.toLocaleDateString('en-us', {
	                        year: 'numeric',
	                        month: 'long',
	                        day: 'numeric',
	                    })}
	                </time>
	                <span class="font-bold text-gray-500 tracking-wide text-lg">                    {readingTime}
                </span>
            </div>
            <h1 class="text-5xl md:text-7xl font-black leading-none mb-8">{post.data.title}</h1>
            
            {post.data.heroImage && (
                <div class="relative mt-12">
                     <div class="absolute inset-0 bg-black translate-x-3 translate-y-3 rounded-lg"></div>
                    <img width={1020} height={510} src={post.data.heroImage} alt="" class="relative border-4 border-black w-full rounded-lg" />
                </div>
            )}
        </header>
        
		<div class="prose prose-xl prose-neutral max-w-none prose-headings:font-black prose-p:font-medium prose-a:text-primary prose-a:font-bold prose-img:border-4 prose-img:border-black prose-img:shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] prose-img:rounded-lg">
			<Content />
		</div>
	</article>
</Layout>
